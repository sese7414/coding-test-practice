/*
문제: 가격대 별 상품 개수 구하기
분류: GROUP BY
링크: https://school.programmers.co.kr/learn/courses/30/lessons/131530
*/

-- 수식
SELECT  PRICE-PRICE%10000 AS PRICE_GROUP, 
        COUNT(*) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP

-- FLOOR, TRUNCATE
SELECT  FLOOR(PRICE/10000) * 10000 AS PRICE_GROUP,
        -- TRUNCATE(PRICE/10000, 0) * 10000 AS PRICE_GROUP,
        -- TRUNCATE(PRICE, -4) AS PRICE_GROUP,
        COUNT(*) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP

-- CASE WHEN
SELECT CASE WHEN PRICE < 10000 THEN 0
            WHEN 10000 <= PRICE AND PRICE < 20000 THEN 10000
            WHEN 20000 <= PRICE AND PRICE < 30000 THEN 20000
            WHEN 30000 <= PRICE AND PRICE < 40000 THEN 30000
            WHEN 40000 <= PRICE AND PRICE < 50000 THEN 40000
            WHEN 50000 <= PRICE AND PRICE < 60000 THEN 50000
            WHEN 60000 <= PRICE AND PRICE < 70000 THEN 60000
            WHEN 70000 <= PRICE AND PRICE < 80000 THEN 70000
            ELSE 80000 END AS PRICE_GROUP,
        COUNT(*) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP

